; Solution for AOC 2015 Day 1 part B, for Amstrad CPC

	org &3000
	ld de, 0
	ld hl, input
	ld bc, 0	

_check_character:
	bit 7, d
	jp nz, the_end ; Check if de is below 0

	ld a, (hl)
	cp 0
	jp z, the_end

	inc bc
	inc hl
	cp 40 ; Left bracket
	jp nz, _go_down

_go_up:
	inc de
	jp _check_character

_go_down: 
	dec de
	jp _check_character

the_end:
	ld h, b
	ld l, c
	call DispHL
	call NewLine	

	ret

DispHL:
	ld	bc,-10000
	call	Num1
	ld	bc,-1000
	call	Num1
	ld	bc,-100
	call	Num1
	ld	c,-10
	call	Num1
	ld	c,-1
Num1:	ld	a,'0'-1
Num2:	inc	a
	add	hl,bc
	jr	c,Num2
	sbc	hl,bc
	call 	&BB5A
	ret 

PrintString:
	ld a, (hl)
	cp 0
	ret z
	inc hl
	call &BB5A ; Firmware, print A to screen as ascii
	jr PrintString

NewLine:
	ld a, 13
	call &BB5A
	ld a, 10
	call &BB5A
	ret

input:
        db "()()(()()()(()()((()((()))((()((((()()((((()))()((((())(((((((()(((((((((()(((()"
        db ")(()()(()((()()(()(())(()((((()((()()()((((())((((((()(()(((()())(()((((()))())("
        db "())(()(()()))))))))((((((((((((()())()())())(())))(((()()()((((()(((()(()(()()(("
        db ")(()()(()(((((((())(())(())())))((()())()((((()()((()))(((()()()())))(())))((((("
        db "))(((()())(())(()))(()((((()())))())((()(())(((()((((()((()(())())))((()))()()(("
        db ")(()))))((((((((()())((((()()((((()(()())(((((()(()())()))())(((()))()(()(()(()("
        db "(((()(())(()))(((((()()(()()()(()(((())())(((()()(()()))(((()()(((())())(()(())("
        db "))()()(())()()()((()(((()(())((()()((())()))((()()))((()()())((((()(()()(()(((()"
        db "))()(()))))((()(((()()()))(()(((())()(()((()())(()(()()(()())(())()(((()(()())()"
        db "((((()((()))))())()))((()()()()(())()())()()()((((()))))(()(((()()(((((((())()))"
        db "()((((()((())()(()())(())()))(()(()())(((((((())))(((()))())))))()))())((())(()("
        db ")((())()())()))))()((()()())(())((())((((()())())()()()(((()))())))()()))())(()("
        db ")()(()((((((()()))())()))()(((()(((())((((()()()(()))())()()))))())()))())((())("
        db ")())(((((())())((())())))(((())(((())(((((()(((((())(()(()())())(()(())(()))(()("
        db "(((()))())()))))())))((()(()))))())))(((((())()))())()))))()))))(((()))()))))((("
        db ")))((()((()(()(())()())))(()()()(())()))()((((())))))))(())(()((()()))(()))(()))"
        db "(()((()))))))()()((((()()))()())()))))))()()()))(()((())(()))((()()()())()(((()("
        db "(((())())))()((((()(()))))))())))()()())()))(()))))(()())()))))))((())))))))())("
        db ")))()((())())))(()((()))()))(())))))(()))()())()()))((()(()))()()()()))))())()()"
        db "))())(())()()))()))((()))))()()(()())))))()()()))((((()))()))))(()(())))(()())))"
        db "((())())(()))()))))()())))()())()())))))))))()()))))())))((())((()))))())))(((()"
        db "())))))))(()))()()))(()))()))))()())))))())((((()())))))))())))()()))))))))()))("
        db ")))))()))))))(())))))))))())))))))))))))))())())((())))))))))()))((())))()))))))"
        db "))())()(()))))))())))))()()()())()(()()()(()())(()))()()()(()())))())())))()))))"
        db "())))))))()()()()())(())())()())()))))(()()()()()))))()))())())))((()())()())))("
        db ")))()))))(()())))()))))))))(((()))()()))))))))))))))))))))(()))(()((()))())))())"
        db "(()))(()(()(())))))()(()))()))()()))))))))))))()((()())(())())()(())))))())()())"
        db "((()()))))(()()))))())()(())()))))))))))))))))))))()))(()(()())))))))()()((()))("
        db ")))))))((())))()))))))))((()))())()()))())()()))((()))())))))))))))(()())()))(()"
        db ")((()(()()))(()())(())))()())(()(())()()))))()))()(()))))))(()))))))))))(()))())"
        db "))))))))())))))())))(())))))()))))(())())))))))))()(()))))()())))())(()))()())))"
        db "))))))))))())()()))))()))))))())))))()))))(())(()()()()((())()))())(()))((())())"
        db ")())())(())(()()))))()))(())()()((())(())))(())))()))())))))))))()(((((())())))("
        db "())()))))(())))((()))()(((((((()))))()()))(())))))()(()))))(()()))()))())))))))("
        db "()())()))))))))())))(()))())()))(())()((())())()())())(()(()))))()))))))((()())("
        db "())()()(()())))()()))(())(())(()))())))()))(()))()()))((((()))))()))((()()()))))"
        db "()))()))())))(()))()))))(())))()))())()(()))()())))())))))))())))())))()()))))))"
        db "(()))())())))()))()()())())))))))))))))())))()))(()()))))())))())()(())))())))))"
        db "))))))))))))()()())())))))()()()((()(()))()()(())()())()))()))))()()()))))))((()"
        db "))))))))()(()(()((((((()()((()())))))))))))()))())))))((())())(()))())))())))))("
        db "))()()())(())))())))()())())(())))))))()()(())))()))())))())())())()))))))))()))"
        db "(()()()())())())))(())())))))))()()())()))))())))())()(())())))))))()())()))(()("
        db ")(())())))()(()((()()((()()(((((())(()())()))(())()))(())))(())))))))()))()))((("
        db ")))()))()))))))))()))))))))((()()())(()))(((()))(())))()))((())(((())))()())))()"
        db ")))))((())))))(())())((((((())())()(()))()(()((()())))((())()(()(()))))(())(()()"
        db "())(())))())((()(((())())))(((()())())))())()(())())((((()()))))())((()))()()()("
        db ")(())(((((((()()()((()))())(()())))(())())((((()()(()))))()((())))((())()))()((("
        db "()))())))()))((()(()))(())(()((((())((((()()(()()))(((())(()))))((((()(()))(()))"
        db ")))((()))(()))((()(((()(()))(()(()((()(())(()(()(()(()()((()))())(((())(()(())))"
        db ")(()))()()))(())))(())()(((())(()))()((((()()))))())(()))))((())()((((()(((()))("
        db "))())(((()))()())((())(())())(())()(())()(()()((((((()()))))()()(((()()))))()())"
        db "()(((()(()))(()(()())(()(()))))(((((()(((())())))))(((((()((()()((())())((((((()"
        db "(())(()()((()()()()()()()(()()))()(((()))()))(((((((())(((()((()())()((((())(((("
        db ")(())))()((()(()()()((())((()())()))()))())))())((((((()))(()(()()()))(()((()(()"
        db "(()))()((()(((()()()((())(((((())()(()))())())((()(())))(()(()())(())((())())())"
        db "(((()()()(())))))())(()))))))()))))))())((()()()))((()((((((()))(((()((((()()()("
        db "((()))())()(()()(((()((()()()()())()()))()()()(()(())((()))))(()))())))))))()(()"
        db "()(((((())()(()(((((()((()(()()())(()((((((((()((((((())()((((()()()((()((()(((("
        db "((()))((())))))))())()))((()(()))()(()()(()((())((()()((((((((((((()())(()()()))"
        db "((((()((((((())(()))())(()()((()()))()(((((((()((()()((((((()(((())))((())))(((("
        db "((((()()(((((((())(((((()())(((())((())()((((()(((((((()(()(((()((((((()(((()((("
        db "((((((((()()((()()(()))((()()(((()(((())))((((())()(()(((())()(()(((())((((((((("
        db "((()))())))((((((())((()()((((()())())((((()()))((())(((((()(()()(()()()((())(()"
        db "((()()((((()(((((()((()(()((((()())((((((()(((((()()(()(()((((())))(())(())(())("
        db "(((()(()()((((()((((()()((()((((((())))(((((()))))()))(()((((((((()(((())())(((("
        db "))))(()(()((())(((()((()()(((((()((()()(((())()(()))(((((((())(()(((((()))((()(("
        db "()((()))(())())((((()((((())()(()))(((()(((((((((((((((())(((((((((()))(((()(()("
        db ")()()((((((()((())()((((((((()(())(((((((((((()(()((())()((()()(()(()()((((()()("
        db "(())(()((()()(()()((((()(((((((())))((((())(())()(((()()((()()((((()((()(((()((("
        db "))(((()()()((((()((((()()(()(()((((((((())(()(((((())(()())(((((((()())()(()(((("
        db "()((())(()()())((((()()(((()((((())(())(()()(((((((((()()))()(((())(()(()((((((("
        db "))(()()())(()))()()(((()(((()((())(()(((((((()(()(()((()(((((()(()((()(()((((((("
        db ")((((()()((((()(((()((())(()(()((()()((((()()(())()(())(((())(()((((((((()())((("
        db "((((((()(())()((((())))()))()()(((((()()((((((())(()()(((()(()(((((((()(()(((((("
        db "(())(())((((()((()(())))((((()()())(()))((()())((((()(((((()(()(())(()(()()())(("
        db "(((()(((((()((((()()((((((((()()))(()((((((())((((())()(()(((()()()(((()(()(())("
        db "())(((((()(())())((((())(())(()(((()(((((())((((())())((()(((((((()(((())(()(())"
        db ")(((((((((()((()((()()(()((((())(((()((())((((())(()(((()(((()(()((((()(((())(()"
        db "(((()(()()(()(()((()()(()())(())())((()(()(((()(((()(((()()(((((((((()(((((((((("
        db ")()(((()(((()())((((()(()(((()()()((())((((((((((())(()(((()((((()())((((()((())"
        db ")(((()()()(((((()(((((((())((()())(()((((())((((((((())(()((()((((((((((()()((()"
        db "((()()))(((()())()())()(((()())()()(()(()(((((((())()))(())()))())()()((())()((("
        db ")((((()((()((())(((((()((((((()(())))(()))())(((()))((()()(()(((()))((((())()((("
        db "()))))()(()(())()(((((())(()(()(())(())()((()()()((((()(())((()())(()(()))(()(()"
        db "(()()(())()()(()((())()((()))))()))((()(()()()()((()())(()))())()(()(((((((((())"
        db "())((()((()((((((())()((((())(((())((()(()()()((())(()((())(((()((((()()((()(()("
        db "((((())()))()((((((()))((())(((()()))(((())(())()))(((((((())(())())()(())(((((("
        db ")))()((()))()(()()((()()()()()())((((((("
        db 0
